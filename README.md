# PDFページ欠落チェックツール (PDF Page Checker)

「自炊」（電子書籍化）したPDFファイルのページ番号（ノンブル）をOCRで読み取り、ページの欠落、重複、順序逆転などを自動的にチェックするPythonアプリケーションです。

GUIで直感的に操作でき、OCRの認識領域（ROI）や画質調整も可能です。

## 詳しい解説・背景
このツールの開発経緯や詳細な使い方は、以下のブログ記事で解説しています。
https://note.com/miya_bee_note/n/nb0b75300aed7

## 主な機能
* **ページ番号の整合性チェック**: 連番になっているか、飛び番号がないかを検証。
* **GUI操作**: ファイル選択から結果確認までGUIで完結。
* **柔軟なOCR設定**:
    * スキャン範囲（ROI）のドラッグ指定（左ページ/右ページ個別設定）。
    * 画質プレビュー機能（2値化しきい値、コントラスト調整）。
    * 横書き（左開き）・縦書き（右開き）の両対応。
* **結果の確認**: 問題のあるページ（欠落・重複など）をリストアップし、該当箇所を画像でプレビュー可能。CSV出力対応。

## 動作環境・必須要件
このツールを動作させるには、Python環境に加え、以下の外部ツールのインストールが必要です。

### 1. Python ライブラリ
以下のコマンドで必要なライブラリをインストールします。

```bash
pip install -r requirements.txt
```

### 2. 外部ツール (必須)
Windows環境の場合、以下の2つのツールをインストールし、アプリ画面上でパスを指定する必要があります。

* **Tesseract-OCR**: 文字認識エンジン
    * インストーラー等でインストールしてください。
    * デフォルトパス: C:\Program Files\Tesseract-OCR\tesseract.exe
* **Poppler**: PDFを画像に変換するためのツール
    * Windows用のバイナリをダウンロードし、適当なフォルダに解凍してください。
    * 設定には bin フォルダのパスが必要です（例: C:\poppler\Library\bin）。

## 使い方
1. リポジトリをクローンまたはダウンロードします。
2. コマンドライン（ターミナル）でディレクトリに移動し、以下を実行します。
   （※元のPythonファイル名を app.py に変更した場合の例です）

   ```bash
   python app.py
   ```

3. アプリが起動したら以下の手順で操作します：
    * **PDF**: チェックしたいPDFファイルを選択。
    * **Poppler/Tesseract**: それぞれのパスを指定（初回のみ）。
    * **ROI設定**: 「ROI設定」ボタンを押し、ページ番号が記載されているエリアを赤枠で囲んで決定します。
    * **解析開始**: ボタンを押すとチェックが始まります。

## 注意事項
* スキャンの画質やフォントによってはOCRが誤認識する場合があります。
* 「画質プレビュー」機能を活用して、数字がくっきり白黒に分かれるようにパラメータ（しきい値など）を調整してください。

## Author
[miya-bee](https://github.com/miya-bee)
